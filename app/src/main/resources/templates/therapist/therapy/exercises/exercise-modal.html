<!DOCTYPE html>
<html lang="en">
<head>
  <div th:replace="~{fragments/header.html}"></div>
  <link href="/styles/therapist/create-exercise.css" rel="stylesheet"/>
</head>
<body class="sb-nav-fixed">

<div class="modal-body">
    <section class="container px-4">
      <h1 class="mt-4 pb-2 mb-3 border-bottom"
          th:text="${exercise?.title ?: 'Новое упражнение'}">Новое упражнение</h1>
      <form class="mt-4"
            enctype="multipart/form-data"
            hx-post=""
            id="exerciseForm"
            th:attr="hx-post=${exercise == null ? '/therapist/exercises/create' : null},hx-put=${exercise != null ? '/therapist/exercises/' + exercise.id : null}"
      >

        <div class="row">
          <div class="col-12 mb-3 col-sm-5 form-floating gx-2">
            <input class="form-control "
                   id="title"
                   name="title"
                   placeholder="Название упражнения"
                   readonly
                   required
                   th:value="${exercise?.title ?: ''}"
                   type="text"
            >
            <label for="title">Название упражнения</label>
          </div>

          <div class="col-12 mb-3 col-sm-5 form-floating gx-2">
            <input class="form-control"
                   id="type"
                   readonly
                   th:value="${exercise?.exerciseType}">
            <label for="type">Тип</label>
          </div>

          <div class="col-12 mb-3 col-sm-2 form-floating gx-2">
            <input class="form-control"
                   id="duration"
                   max="180"
                   min="0"
                   name="duration"
                   readonly
                   required
                   step="0.5"
                   th:value="${T(pro.azhidkov.platform.java.time.DurationExtKt).toDecimalMinutes(exercise?.duration) ?: '1'}"
                   type="number"
            >
            <label for="duration">Длительность</label>
          </div>
        </div>

        <div class="row mb-5">
          <div class="col form-floating gx-2">
                <textarea class="form-control"
                          id="description"
                          name="description"
                          placeholder="Глубоко вдохните..."
                          readonly
                          required
                          rows="10"
                          style="height: 15rem"
                          th:text="${exercise?.description ?: ''}">
                </textarea>
            <label for="description">Описание упражнения</label>
          </div>
        </div>

        <div class="border-1">
          <ul class="nav nav-tabs mb-3">
            <li class="nav-item">
              <a class="nav-link active" href="#">Шаги</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled " href="#">Манипуляции</a>
            </li>
          </ul>
          <div class="row">
            <div th:if="${steps != null}">
              <div id="steps">
                <div th:each="step, iterStat : ${steps}">
                  <div class="card mb-3">
                    <div class="mb-3 p py-2 px-3 bg-light d-flex align-items-end rounded">
                      <div class="col-9 col-sm-10">
                        <h5>Шаг <span th:text="${iterStat.index + 1}">1</span></h5>
                      </div>
                    </div>
                    <div class="row align-items-center px-3 mb-3">
                      <div class="col-sm-2 mb-3 text-center mx-auto">
                        <label class="align-items-center"
                               th:for="|stepImageInput${iterStat.index}|">
                          <div class="row h-100">
                            <div class="col image-container text-end">
                              <img class="mw-100 d-block"
                                   style="max-height: 15rem; margin-top: -43px"
                                   th:id="|stepImage${iterStat.index}|"
                                   th:src="${step.imageUrl}">
                            </div>
                          </div>
                        </label>
                        <input accept="image/*"
                               class="form-control d-none"
                               th:disabled="${true}"
                               th:id="|stepImageInput${iterStat.index}|"
                               th:name="|stepImage${iterStat.index}|"
                               type="file"/>
                      </div>
                      <div class="col-sm-10 form-floating gx-2">
                                <textarea class="form-control"
                                          placeholder="Глубоко вдохните..."
                                          readonly
                                          required
                                          style="height: 15rem"
                                          th:disabled="${true}"
                                          th:name="|steps[${iterStat.index}].description|">[[${step.description}]]</textarea>
                        <label th:for="|steps[${iterStat.index}].description|">Описание шага</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>


      </form>
    </section>

</div>
<div class="modal-footer">
  <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Close</button>
</div>
</body>
</html>